(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{142:function(e,t,n){"use strict";var a=n(0),r=n.n(a);n(259);t.a=function(){return r.a.createElement("div",{className:"loadcontainer"},r.a.createElement("div",{className:"bar"}))}},257:function(e,t,n){var a=n(258);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(a,r);a.locals&&(e.exports=a.locals)},258:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,".video-container {\n  margin-top: 24px;\n  position: relative;\n  width: 100%;\n  height: 0;\n  padding-bottom: 56.25%;\n}\n.video-container iframe {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n\n.create-section .video-container {\n  -webkit-animation: slideDown 0.5s ease;\n          animation: slideDown 0.5s ease;\n}",""])},259:function(e,t,n){var a=n(260);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(a,r);a.locals&&(e.exports=a.locals)},260:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,".loadcontainer {\n  margin-bottom: 20px;\n  display: flex;\n  justify-content: center;\n}\n\n.bar {\n  width: 50%;\n  height: 20px;\n  border: 1px solid #2980b9;\n  border-radius: 3px;\n  background-image: repeating-linear-gradient(-45deg, #2980b9, #2980b9 11px, #eee 10px, #eee 20px);\n  background-size: 28px 28px;\n  -webkit-animation: move 0.5s linear infinite;\n          animation: move 0.5s linear infinite;\n}\n\n@-webkit-keyframes move {\n  0% {\n    background-position: 0 0;\n  }\n  100% {\n    background-position: 28px 0;\n  }\n}\n\n@keyframes move {\n  0% {\n    background-position: 0 0;\n  }\n  100% {\n    background-position: 28px 0;\n  }\n}",""])},264:function(e,t,n){var a=n(265);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(a,r);a.locals&&(e.exports=a.locals)},265:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,'.status-container {\n  border: 1px solid #2B303A;\n  border-width: 1px 1px 1px 0;\n  border-radius: 0 2px 2px 0;\n  height: 32px;\n  width: 32px;\n  background: #fff;\n}\n\n.status-valid {\n  display: inline-block;\n  transform: rotate(45deg);\n  height: 25px;\n  width: 12px;\n  margin-left: 10px;\n  border-bottom: 7px solid #78b13f;\n  border-right: 7px solid #78b13f;\n}\n\n.status-pending {\n  border-radius: 50%;\n  border: 3px solid orange;\n  height: 22px;\n  width: 22px;\n  margin-top: 4px;\n  margin-left: 4px;\n  border-left-color: white;\n  -webkit-animation: infinite-spinning 2s infinite;\n          animation: infinite-spinning 2s infinite;\n}\n\n.status-error {\n  position: relative;\n  /* right: 32px; */\n  /* top: 32px; */\n  width: 32px;\n  height: 32px;\n  opacity: 0.3;\n}\n\n.status-error:before, .status-error:after {\n  position: absolute;\n  left: 15px;\n  content: " ";\n  height: 30px;\n  width: 4px;\n  background-color: #d64933;\n}\n\n.status-error:before {\n  transform: rotate(45deg);\n}\n\n.status-error:after {\n  transform: rotate(-45deg);\n}\n\n@-webkit-keyframes infinite-spinning {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes infinite-spinning {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}',""])},266:function(e,t){},37:function(e,t,n){"use strict";var a=n(0),r=n.n(a);n(264);t.a=function(e){var t=e.status;return r.a.createElement("div",{className:"status-container"},r.a.createElement("div",{className:"".concat(null===t?"status-unset":"error"===t?"status-error":"pending"===t?"status-pending":"success"===t&&"status-valid")}))}},399:function(e,t,n){var a=n(400);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(a,r);a.locals&&(e.exports=a.locals)},400:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,'@font-face {\n  font-family: "orkneyregular";\n  src: url("/fonts/Orkney Regular.woff2") format("woff2"), url("/fonts/Orkney Regular.woff") format("woff");\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: "orkneybold";\n  src: url("/fonts/Orkney Bold.woff2") format("woff2"), url("/fonts/Orkney Bold.woff") format("woff");\n  font-weight: normal;\n  font-style: normal;\n}\nh1, h2, h3, h4, h5, h6 {\n  margin: 0;\n  font-family: "orkneybold";\n}\n\na {\n  color: inherit;\n  text-decoration: none;\n}\n\nfigcaption {\n  width: 100%;\n  font-style: italic;\n  font-size: 12px;\n  color: gray;\n  margin: 8px 0 0 16px;\n}\nfigcaption a {\n  text-decoration: underline;\n}\n\ncaption {\n  width: 100%;\n  color: gray;\n  font-size: 12px;\n  display: block;\n}\n\n.create-trail-wrapper {\n  display: grid;\n  grid-template-columns: 1fr;\n}\n.create-trail-wrapper input {\n  width: 350px;\n}\n.create-trail-wrapper .text-section {\n  padding: 12px 0;\n  border-bottom: 1px solid gray;\n  margin-bottom: 0;\n}\n.create-trail-wrapper .text-section h6 {\n  margin-bottom: 8px;\n}\n.create-trail-wrapper .create-section {\n  padding: 12px 0;\n  border-bottom: 1px solid gray;\n  margin-bottom: 0;\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  grid-gap: 36px;\n}\n.create-trail-wrapper .create-section .input-section {\n  width: 100%;\n}\n.create-trail-wrapper h5 {\n  margin-bottom: 8px;\n}\n\n.input-status-wrapper {\n  display: flex;\n}\n.input-status-wrapper input[type=text] {\n  border: 1px solid #2B303A;\n  border-right: 0;\n  border-radius: 0 2px 2px 0;\n}\n\ntextarea {\n  width: 100%;\n  height: 150px;\n}\n\n.ReactTags__tag {\n  background: #0C7C59;\n  padding: 4px;\n  border-radius: 2px;\n  margin-right: 8px;\n  color: #fff;\n  margin-bottom: 8px;\n  display: inline-block;\n}\n\n.ReactTags__remove {\n  margin-left: 8px;\n}\n\n.upload-buttons-container {\n  display: flex;\n  margin-bottom: 16px;\n}\n\n.button-wrapper {\n  display: grid;\n  margin: 36px 0;\n}\n@media (min-width: 768px) {\n  .button-wrapper {\n    grid-template-columns: 1fr 1fr;\n    grid-gap: 24px;\n  }\n}',""])},42:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(e,t){var n;return function(){for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];var i=this;n&&clearTimeout(n),n=setTimeout((function(){n=null,e.apply(i,r)}),t)}}},549:function(e,t,n){var a=n(550);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(a,r);a.locals&&(e.exports=a.locals)},550:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,".drag-area {\n  width: 100%;\n  height: 75px;\n  border: 3px dashed #0C7C59;\n  border-radius: 3px;\n  margin: 12px 0;\n  background-color: #EFEFEF;\n  color: #2B303A;\n}\n\n.remove-images-button {\n  padding: 0;\n  background: inherit;\n  color: #0C7C59;\n  border: 0;\n  text-decoration: underline;\n}\n\n.image-item {\n  max-width: 100px;\n  position: relative;\n  height: 100px;\n}\n.image-item__btn-wrapper {\n  position: absolute;\n  top: 0;\n  right: 0;\n  background: #fff;\n}\n.image-item img {\n  height: 100%;\n  -o-object-fit: cover;\n     object-fit: cover;\n}\n.image-item .remove-button {\n  height: 0;\n  border: 0;\n}\n\n.image-preview-area {\n  display: grid;\n  grid-template-columns: 1fr 1fr 1fr;\n  grid-gap: 10px;\n}",""])},562:function(e,t,n){var a=n(563);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(a,r);a.locals&&(e.exports=a.locals)},563:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,".strava-routes li {\n  -webkit-animation: slideDown 0.5s ease;\n          animation: slideDown 0.5s ease;\n  margin-left: 0;\n  width: 100%;\n  position: relative;\n}\n.strava-routes li > p {\n  padding-right: 64px;\n}\n.strava-routes p {\n  margin: 0;\n}\n\n.select-route {\n  position: absolute;\n  top: 7px;\n  right: 7px;\n  padding: 4px 8px;\n  display: flex;\n}\n.select-route p {\n  height: 16px;\n  padding: 0;\n}",""])},564:function(e,t,n){var a=n(565);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(a,r);a.locals&&(e.exports=a.locals)},565:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,".create-preview-map {\n  width: 300px;\n  height: 300px;\n}",""])},566:function(e,t,n){var a=n(567);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(a,r);a.locals&&(e.exports=a.locals)},567:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,"button.strava-button {\n  background-image: url(/images/btn_strava_connectwith_orange.svg);\n  width: 185px;\n  height: 40px;\n  background-size: 185px 40px;\n  background-color: inherit;\n  margin-left: 8px;\n}\nbutton.strava-button:focus {\n  outline: none;\n}",""])},568:function(e,t,n){var a=n(569);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(a,r);a.locals&&(e.exports=a.locals)},569:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,".buttons {\n  display: flex;\n}\n\n.page-number {\n  height: 40px;\n  width: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}",""])},570:function(e,t,n){var a=n(571);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(a,r);a.locals&&(e.exports=a.locals)},571:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,".message-bar {\n  position: fixed;\n  top: -40px;\n  left: 0;\n  height: 40px;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: #0C7C59;\n  color: #bac1b8;\n  z-index: 400;\n}\n.message-bar.active {\n  top: 0;\n}",""])},626:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n.n(a),o=n(2),i=n.n(o),c=n(0),l=n.n(c),s=n(9),u=n(18),p=(n(399),n(145)),m=n.n(p),d=n(101),f=n.n(d),g=n(102),v=n.n(g),h=n(66),b=n.n(h),y=n(103),x=n.n(y),w=n(104),E=n.n(w),k=n(51),O=n.n(k),j=(n(26),n(231));function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=O()(e);if(t){var r=O()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return E()(this,n)}}var N=[188,2,13],D=function(e){x()(n,e);var t=C(n);function n(e){var a;return f()(this,n),(a=t.call(this,e)).handleDelete=a.handleDelete.bind(b()(a)),a.handleAddition=a.handleAddition.bind(b()(a)),a.handleDrag=a.handleDrag.bind(b()(a)),a}return v()(n,[{key:"handleDelete",value:function(e){var t=this.props.tagsArea.tags,n=this.props.setTagArea,a=t.filter((function(t,n){return n!==e}));n((function(e){return S(S({},e),{},{tags:a})}))}},{key:"handleAddition",value:function(e){var t=this;(0,this.props.setTagArea)((function(n){return S(S({},n),{},{tags:[].concat(m()(t.props.tagsArea.tags),[e])})}))}},{key:"handleDrag",value:function(e,t,n){var a=this.props.setTagArea,r=m()(this.props.tagsArea.tags).slice();r.splice(t,1),r.splice(n,0,e),a((function(e){return S(S({},e),{},{tags:r})}))}},{key:"render",value:function(){var e=this.props.tagsArea,t=e.tags,n=e.suggestions;return l.a.createElement("div",null,l.a.createElement(j.WithContext,{tags:t,suggestions:n,handleDelete:this.handleDelete,handleAddition:this.handleAddition,handleDrag:this.handleDrag,delimiters:N,autofocus:!1}))}}]),n}(l.a.Component),R=n(42),I=n(8),P=n.n(I),A=n(37),U=n(36),T=n.n(U),F=n(232),z=n.n(F),G=(n(549),n(552),new(n(551)),function(e){var t=e.onImageChange,n=e.images;return l.a.createElement("div",{className:"App"},l.a.createElement(z.a,{multiple:!0,value:n,onChange:t,maxNumber:24,dataURLKey:"data_url"},(function(e){var t=e.imageList,n=e.onImageUpload,a=e.onImageRemoveAll,r=(e.onImageUpdate,e.onImageRemove),o=e.isDragging,i=e.dragProps;return l.a.createElement("div",{className:"upload__image-wrapper"},l.a.createElement("button",T()({style:o?{color:"red"}:void 0,onClick:n},i,{className:"drag-area"}),"".concat(Object(s.a)("Click or Drop here"))),l.a.createElement("div",{className:"image-preview-area"},t.map((function(e,t){return l.a.createElement("div",{key:t,className:"image-item"},l.a.createElement("img",{src:e.data_url||e,alt:"",width:"100"}),l.a.createElement("div",{className:"image-item__btn-wrapper"},l.a.createElement("button",{className:"remove-button",onClick:function(){return r(t)}},"X")))}))),l.a.createElement("button",{onClick:a,className:"remove-images-button"},"Remove all images"))})))}),B=n(99),J=n(65),W=n(100),M=n.n(W),X=n(632);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=function(e){if(e){var t=(new DOMParser).parseFromString(e,"application/xml"),n=Object(B.gpx)(t);if(console.log(n),0===n.features.length)return!1;for(var a=n.features[0].properties.name,r=Object(J.zipWith)(n.features[0].geometry.coordinates,n.features[0].properties.coordTimes,(function(e,t){return{lon:e[0],lat:e[1],elevation:e[2],time:t,distance:0}})),o=Object(X.a)(new Date(r[r.length-1].time),new Date(r[0].time)),i=0,c=0,l=0,s=0;s<r.length-1;s++){var u={latitude:r[s].lat,longitude:r[s].lon},p={latitude:r[s+1].lat,longitude:r[s+1].lon};l+=M()(u,p),r[s+1].distance=l;var m=r[s+1].distance-r[s].distance,d=r[s+1].elevation-r[s].elevation;d>0?i+=d:c+=d,r[s+1].slope=d/(1e3*m)*100}return{coords:r,distance:l,ascent:i,descent:c,time:o,name:a}}};var H=n(17),K=n(233),Q=n.n(K),V=n(94),$=n(50),ee=n(95),te=(n(562),n(144)),ne=function(e){var t=e.stravaRoutes,n=e.selectStravaRoute;return l.a.createElement("div",{className:"route-list"},l.a.createElement("ul",{className:"strava-routes"},t.length>=0&&t.map((function(e){var t=new Date(e.start_date);return l.a.createElement("li",{key:e.id},l.a.createElement("p",null,t.toLocaleDateString("en-GB",te.a.timeFormat)," - ",e.name),l.a.createElement("button",{className:"select-route secondary",type:"button",onClick:function(){return n(e)}},l.a.createElement("p",null,"Select")))}))))},ae=n(142),re=n(635),oe=n(637),ie=n(636),ce=n(618),le=(n(564),L.icon({iconRetinaUrl:n(69),iconUrl:n(69),iconSize:[20,20],iconAnchor:[3,20]})),se=L.icon({iconRetinaUrl:n(70),iconUrl:n(70),iconSize:[20,20],iconAnchor:[3,20]}),ue=(L.icon({iconRetinaUrl:n(71),iconUrl:n(71),iconSize:[20,20],iconAnchor:[10,10]}),function(e){var t=e.route;return l.a.createElement(re.a,{className:"create-preview-map",id:"mapid",scrollWheelZoom:!1,bounds:t},l.a.createElement(oe.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://api.mapbox.com/styles/v1/willmadd/".concat("cka5ncmgs19io1io3qn27wejb","/tiles/{z}/{x}/{y}?access_token=")+"pk.eyJ1Ijoid2lsbG1hZGQiLCJhIjoiY2thNW43amlvMDFteDNtcGEyMWpxeWwzcCJ9.wfx7i_G1rWq3roofKl7XhQ"}),l.a.createElement(ie.a,{positions:t}),l.a.createElement(ce.a,{position:t[0],icon:le}),l.a.createElement(ce.a,{position:t[t.length-1],icon:se}))}),pe=(n(566),function(e){var t=e.setStravaRoutes,n=e.setStravaLoading,a=e.page;Object(c.useEffect)((function(){r()}),[a]);var r=function e(){if(n(!0),localStorage.getItem("trailshub:strava:access_token")){var a=localStorage.getItem("trailshub:strava:access_token");s(a).then((function(e){var a=e.data.filter((function(e){return e.map.summary_polyline}));t(a),n(!1)})).catch((function(t){if(console.log("error"),console.log(t),localStorage.getItem("trailshub:strava:refresh_token")){var n=localStorage.getItem("trailshub:strava:refresh_token");u(n).then((function(t){console.log(t);var n=t.data.access_token;localStorage.setItem("trailshub:strava:access_token",n),e()}))}else o("strava")}))}else o("strava")},o=function(e){var t="http://www.strava.com/oauth/authorize?client_id=57029&response_type=code&redirect_uri=http://localhost:8000/strava_auth&approval_prompt=force&scope=activity:read_all",n=null,a=null;window.removeEventListener("message",i);var r="toolbar=no, menubar=no, width=600, height=700, top=100, left=100";null===n||n.closed?n=window.open(t,e,r):a!==t?(n=window.open(t,e,r)).focus():n.focus(),window.addEventListener("message",(function(e){return i(e)}),!1),a=t},i=function(e){var a=e.data.match(/(?<=code=).+.*?(?=\&)/)[0],r=new FormData;r.append("client_id","57029"),r.append("client_secret","eb49b882ac23ed975c7b12273ed2eb38953a9d70"),r.append("code",a),r.append("grant_type","authorization_code"),P()({method:"post",url:"https://www.strava.com/oauth/token",data:r,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){var a=e.data,r=a.access_token,o=a.refresh_token;localStorage.setItem("trailshub:strava:access_token",r),localStorage.setItem("trailshub:strava:refresh_token",o),s(r).then((function(e){console.log(e);var a=e.data.filter((function(e){return e.map.summary_polyline}));console.log(a),t(a),n(!1)}))}))},s=function(e){return P.a.get("https://www.strava.com/api/v3/athlete/activities?access_token=".concat(e,"&page=").concat(a))},u=function(e){var t=new FormData;return t.append("client_id","57029"),t.append("client_secret","eb49b882ac23ed975c7b12273ed2eb38953a9d70"),t.append("refresh_token",e),t.append("grant_type","refresh_token"),P()({method:"post",url:"https://www.strava.com/oauth/token",data:t,headers:{"Content-Type":"multipart/form-data"}})};return l.a.createElement("div",null,l.a.createElement("button",{type:"button",onClick:function(){return r()},className:"strava-button"}))}),me=n(235),de=function(e){var t=e.handleGpxFile;return l.a.createElement(me.a,{onDrop:function(e){return function(e){e.forEach((function(e){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsText(e)}))}(e)}},(function(e){var t=e.getRootProps,n=e.getInputProps,a=e.isDragActive;return l.a.createElement("section",null,l.a.createElement("div",T()({className:"button"},t()),l.a.createElement("input",n()),a?l.a.createElement("p",null,"Drop GPX file here ..."):l.a.createElement("p",null,"Upload a GPX file")))}))};n(568);function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ve=function(e){var t=e.createTrail,n=e.handleGpxFile,a=e.setStravaRoutes,r=e.setStravaLoading,o=e.stravaLoading,s=e.stravaRoutes,u=e.handleStravaRoute,p=e.loading,m=e.setCreateTrail,d=Object(c.useState)(1),f=i()(d,2),g=f[0],v=f[1],h=function(e){$.animateScroll.scrollTo(400),v(e)};return console.log(t),console.log(t.coords),l.a.createElement("div",null,l.a.createElement("h5",null,"Upload your trail"),l.a.createElement("div",{className:"upload-buttons-container"},t.coords.length&&!p?l.a.createElement("button",{className:"secondary",type:"button",onClick:function(){return m((function(e){return ge(ge({},e),{},{coords:[],distance:null,ascent:null,descent:null,time:null})}))}},"Remove File"):l.a.createElement(l.a.Fragment,null,l.a.createElement(de,{handleGpxFile:n}),l.a.createElement(pe,{setStravaRoutes:a,setStravaLoading:r,page:g}))),o&&l.a.createElement(ae.a,null),!o&&s.length>=1&&!t.coords.length&&l.a.createElement(ne,{stravaRoutes:s,selectStravaRoute:u,setPage:v,page:g}),!o&&s.length>=1&&!t.coords||g>1&&l.a.createElement("div",{className:"buttons"},l.a.createElement("button",{type:"button",onClick:function(){return h(g>1?g-1:1)},disabled:1===g},"<"),l.a.createElement("div",{className:"page-number"},"".concat(g)),l.a.createElement("button",{type:"button",onClick:function(){return h(g+1)},disabled:0===s.length},">")),t.coords&&t.coords.length>0&&l.a.createElement("div",null,"File Uploaded",l.a.createElement(ue,{route:t.coords})))},he=(n(570),function(e){var t=e.message;e.active;return t?l.a.createElement("div",{className:"active message-bar"},l.a.createElement("h4",null,t)):null});function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(e){var t=e.location,n=Object(c.useState)({title:"",activity:"mtb",difficulty:1,youtube_link:"",summary:"",description:"",strava_link:"",gpx:"",status:"new",coords:[]}),a=i()(n,2),o=a[0],p=a[1],m=Object(c.useState)([]),d=i()(m,2),f=d[0],g=d[1],v=Object(c.useState)(!1),h=i()(v,2),b=h[0],y=h[1],x=l.a.useState([]),w=i()(x,2),E=w[0],k=w[1],O=l.a.useState(""),j=i()(O,2),_=j[0],S=j[1],C=l.a.useState({tags:[],suggestions:[]}),N=i()(C,2),I=N[0],U=N[1],T=Object(c.useState)(!0),F=i()(T,2),L=F[0],z=F[1],B=Object(c.useState)(null),J=i()(B,2),W=J[0],M=J[1],X=Object(c.useState)(null),Y=i()(X,2),K=Y[0],te=Y[1];Object(c.useEffect)((function(){var e=t.state?t.state.id:null;e?(z(!0),H.b(e).then((function(e){p((function(t){return ye(ye(ye({},t),e.data.trail),{},{coords:JSON.parse(e.data.trail.coords),slug:Object(u.a)(decodeURIComponent(e.data.trail.title))})})),Object(V.a)(decodeURIComponent(e.data.trail.youtube_link))&&te("success"),U((function(t){return ye(ye({},t),{},{tags:e.data.tags.map((function(e){return{id:e,text:e}}))})}));var t=e.data.images.map((function(e){return{data_url:e}}));k(t),z(!1)}))):z(!1)}),[]);var ne=function(e){var t,n=(t=o.coords,Array.isArray(t[0])?(console.log("is ar"),{start_lat:t[0][0],start_lng:t[0][1]}):(console.log("is not arr"),{start_lat:t[0].lat,start_lng:t[0].lon})),a={activity:o.activity,ascent:o.ascent,coords:JSON.stringify(o.coords),distance:o.distance,descent:o.descent,description:o.description,difficulty:o.difficulty,gpx:o.gpx,hire_centre:null,images:E.map((function(e){return e.data_url})),slug:o.slug,strava_link:o.strava_link,summary:o.summary,tags:I.tags.map((function(e){return Object(u.a)(e.text)})),time:o.time,title:o.title,youtube_link:o.youtube_link,status:e,id:o.id};console.log("-=-=-=-=-="),console.log(ye(ye({},a),n)),H.f(ye(ye({},a),n)).then((function(e){S("Trail Saved"),p((function(t){return ye(ye({},t),{},{id:e.data.id})})),setTimeout((function(){S("")}),1e3)}))},ae=l.a.useCallback(Object(R.a)((function(e){return ie(e)}),1e3),[]),re=l.a.useCallback(Object(R.a)((function(e){return oe(e)}),1e3),[]),oe=function(e){var t=/(?:youtube(?:-nocookie)?\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|vi|e(?:mbed)?)\/|\S*?[?&]v=|\S*?[?&]vi=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/.test(e);te(t?"success":"error")},ie=function(e){M("loading"),P.a.get("/api/trail/slugverification/".concat(e)).then((function(e){e.data?M("error"):M("success")})).catch((function(e){M("error")}))},ce=function(e){var t=e.target,n=t.name,a=t.value;"title"===n?le(n,a):p((function(e){return ye(ye({},e),{},r()({},n,encodeURIComponent(a)))}))},le=function(e,t){ae(t),p((function(n){var a;return ye(ye({},n),{},(a={},r()(a,e,encodeURIComponent(t)),r()(a,"slug",encodeURIComponent(Object(u.a)(t))),a))}))};return l.a.createElement("div",{className:"create-trail-wrapper"},l.a.createElement(he,{message:_}),l.a.createElement("h3",null,Object(s.a)("Create a trail")),l.a.createElement("label",{className:"create-section"},l.a.createElement("div",{className:"input-section"},l.a.createElement("h5",null,Object(s.a)("Choose a name for your trail")),l.a.createElement("div",{className:"input-status-wrapper"},l.a.createElement("input",{type:"text",name:"title",onChange:function(e){return ce(e)},value:o.title?decodeURIComponent(o.title):"",placeholder:"Trail Title"}),l.a.createElement(A.a,{status:W}))),l.a.createElement("div",null,l.a.createElement("h6",null,"Trail Names must be unique"),l.a.createElement("p",null,"url will be https://www.trailshub.com/".concat(Object(u.a)(decodeURIComponent(o.title))))),l.a.createElement("input",{type:"hidden",name:"slug",onChange:function(e){return ce(e)},value:Object(u.a)(o.title)})),l.a.createElement("div",{className:"create-section"},l.a.createElement("div",{className:"input-section"},l.a.createElement(ve,{createTrail:o,setCreateTrail:p,handleGpxFile:function(e){console.log("gpx file hit"),console.log(e),p((function(t){return ye(ye(ye({},t),function(e){console.log("set gpx");var t=q(e);if(console.log(t),t){var n=t.coords.map((function(e){return{lat:e.lat,lon:e.lon,ele:e.elevation,time:e.time}})).filter((function(e,t){return t%12==11}));return Z(Z({},t),{},{route:n})}return!1}(e)),{},{gpx:e})}))},setStravaRoutes:g,setStravaLoading:y,stravaLoading:b,stravaRoutes:f,handleStravaRoute:function(e){var t=e.map.summary_polyline,n=Q.a.decode(t),a=r()({coords:n,time:e.moving_time,ascent:e.total_elevation_gain,descent:e.total_elevation_gain},"time",e.distance);p((function(e){return ye(ye({},e),a)}));var o={strava_link:e.id};p((function(e){return ye(ye({},e),o)})),$.animateScroll.scrollTo(400)},loading:L})),l.a.createElement("h6",null,"Please upload your trail. You can do this by selecting one of your Strava routes, or uploading a GPX file")),l.a.createElement("label",{className:"create-section"},l.a.createElement("div",{className:"input-section"},l.a.createElement("h5",null,"Youtube link"),l.a.createElement("div",{className:"input-status-wrapper"},l.a.createElement("input",{type:"text",name:"youtube_link",id:"youtube_link",onChange:function(e){return function(e){var t=e.target,n=t.name,a=t.value;re(a),p((function(e){return ye(ye({},e),{},r()({},n,encodeURIComponent(a)))}))}(e)},placeholder:"e.g. https://www.youtube.com/watch?v=ustbfMr-3bc",value:o.youtube_link?decodeURIComponent(o.youtube_link):""}),l.a.createElement(A.a,{status:K})),"success"===K&&l.a.createElement(ee.a,{url:o.youtube_link?decodeURIComponent(o.youtube_link):""})),l.a.createElement("h6",null,"All trails must include a video")),l.a.createElement("label",{className:"create-section"},l.a.createElement("div",{className:"input-section"},l.a.createElement("h5",null,"Images"),l.a.createElement(G,{onImageChange:function(e,t){console.log(e),k(e),handleInputChange=function(t){var n=[];e.foreach((function(e,t){var a=new FileReader;a.onload=function(){n.push(a.result)},a.readAsDataURL(e)}))}},images:E})),l.a.createElement("div",null,l.a.createElement("h6",null,"Image Uploads are optional, they will appear on your back, and also your trail thumbnail, if no images are supplied then we will use a still from your video as a thumbnail"),l.a.createElement("p",null,"please format images as .jpg, .png or .gif"),l.a.createElement("p",null,"You can include up to 12 images"))),l.a.createElement("label",{className:"create-section"},l.a.createElement("div",{className:"input-section"},l.a.createElement("h5",null,"Type of trail"),l.a.createElement("select",{name:"activity",value:o.activity?decodeURIComponent(o.activity):"",onChange:function(e){return ce(e)}},l.a.createElement("option",{value:"mtb"},"Mountain Bike")))),l.a.createElement("label",{className:"create-section"},l.a.createElement("div",{className:"input-section"},l.a.createElement("h5",null,"Difficulty"),l.a.createElement("select",{name:"difficulty",value:o.difficulty?decodeURIComponent(o.difficulty):"",onChange:function(e){return ce(e)}},l.a.createElement("option",{value:1},"Easy"),l.a.createElement("option",{value:2},"Intermediate"),l.a.createElement("option",{value:3},"Hard"),l.a.createElement("option",{value:4},"Extreme"),l.a.createElement("option",{value:5},"Family"))),l.a.createElement("h6",null,"Please select the difficulty of this trail from Easy, Intermediate, Hard, Extreme or Family")),l.a.createElement("label",{className:"text-section"},l.a.createElement("h5",null,"Description"),l.a.createElement("h6",null,"The more detailed the description, the better your trail will rank in search engines, and the more views you will get"),l.a.createElement("textarea",{type:"textarea",name:"description",id:"description",onChange:function(e){return ce(e)},value:o.description?decodeURIComponent(o.description):""})),l.a.createElement("label",{className:"text-section"},l.a.createElement("div",{className:"input-section"},l.a.createElement("h5",null,"Summary"),l.a.createElement("h6",null,"A single paragraph that described your trail"),l.a.createElement("textarea",{type:"textarea",name:"summary",id:"summary",onChange:function(e){return ce(e)},value:o.summary?decodeURIComponent(o.summary):""}))),l.a.createElement("label",{className:"create-section"},l.a.createElement("div",{className:"input-section"},l.a.createElement("h5",null,"Add some tags"),l.a.createElement(D,{tagsArea:I,setTagArea:U}))),l.a.createElement("div",{className:"button-wrapper"},"approved"===o.status?l.a.createElement("button",{type:"button",onClick:function(){return ne("pending")}},"Update Trail"):l.a.createElement(l.a.Fragment,null,l.a.createElement("button",{type:"button",onClick:function(){return ne("pending")}},"Submit Live"),l.a.createElement("button",{type:"button",className:"secondary",onClick:function(){return ne("draft")}},"Save draft"))))}},69:function(e,t){e.exports="/images/startflag.svg?c10530f310f559392b32dd257764b1ce"},70:function(e,t){e.exports="/images/endflag.svg?9e63e156ad7baef770662c85ad851070"},71:function(e,t){e.exports="/images/crosshair.svg?ecf3069a29b25dd2040da756f882757d"},94:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(e){var t=e.match(/(?:youtube(?:-nocookie)?\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|vi|e(?:mbed)?)\/|\S*?[?&]v=|\S*?[?&]vi=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);return!(!t||!t[1])&&t[1]}},95:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=(n(257),n(94));t.a=function(e){var t=e.url;return r.a.createElement("div",{className:"video-container"},r.a.createElement("iframe",{className:"youtube-iframe",src:"https://www.youtube.com/embed/".concat(Object(o.a)(t)),frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}))}}}]);